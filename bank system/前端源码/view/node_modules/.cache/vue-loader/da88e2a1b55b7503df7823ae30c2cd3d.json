{"remainingRequest":"/Users/caspian/Desktop/银行业务处理模拟平台/view/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/caspian/Desktop/银行业务处理模拟平台/view/src/components/Transaction.vue?vue&type=style&index=0&id=3d8771de&scoped=true&lang=css&","dependencies":[{"path":"/Users/caspian/Desktop/银行业务处理模拟平台/view/src/components/Transaction.vue","mtime":1603001747807},{"path":"/Users/caspian/Desktop/银行业务处理模拟平台/view/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/caspian/Desktop/银行业务处理模拟平台/view/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/caspian/Desktop/银行业务处理模拟平台/view/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/caspian/Desktop/银行业务处理模拟平台/view/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/caspian/Desktop/银行业务处理模拟平台/view/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKZGl2ewogICAgbWFyZ2luOjA7CiAgICBwYWRkaW5nOjA7Cn0KLnRvcCB7CiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjZmZmOwogICAgbWFyZ2luLXRvcDogLTIuOHJlbTsKICAgIG1hcmdpbi1ib3R0b206IDNyZW07CiAgICBib3JkZXItYm90dG9tLXJpZ2h0LXJhZGl1czogMS4ycmVtOwogICAgCn0KLnRvcC10aXRsZXsKICAgIGJhY2tncm91bmQtY29sb3I6ICNmZmY7CiAgICBoZWlnaHQ6NnJlbTsKICAgIGZvbnQtc2l6ZTogMi41cmVtOwogICAgZm9udC13ZWlnaHQ6IGJvbGQ7CiAgICB0ZXh0LWFsaWduOiBzdGFydDsKICAgIHBhZGRpbmctbGVmdDogMnJlbTsKICAgIHBhZGRpbmctdG9wOiAxLjNyZW07CiAgICBjb2xvcjogIzI3NjNkNTsKfQouY29udHJvbGwtYnV0dG9uewogICAgYmFja2dyb3VuZC1jb2xvcjogI2ZmZjsKfQouZWwtYnV0dG9uewogICAgZm9udC13ZWlnaHQ6IGJvbGQ7CiAgICBmb250LXNpemU6IDEuMjdyZW07CiAgICBtYXJnaW4tdG9wOiAxLjlyZW07Cn0KLnVwewogICAgdGV4dC1hbGlnbjogc3RhcnQ7CiAgICBmb250LXNpemU6IDEuMXJlbTsKICAgIGZvbnQtd2VpZ2h0OiBib2xkOwogICAgY29sb3I6ICNiMGIwYmI7CiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjZmZmOwogICAgbWFyZ2luLWJvdHRvbTogLjJyZW07CiAgICBwYWRkaW5nLWxlZnQ6IDByZW07CiAgICBtYXJnaW4tdG9wOiAxcmVtOwp9Ci5kb3duewogICAgdGV4dC1hbGlnbjogc3RhcnQ7CiAgICBtYXJnaW4tdG9wOiAwLjVyZW07CiAgICBmb250LXNpemU6IDJyZW07CiAgICBmb250LXdlaWdodDogYm9sZDsKICAgIGNvbG9yOiAjMjcyNTMyOwogICAgYmFja2dyb3VuZC1jb2xvcjogI2ZmZjsKICAgIHBhZGRpbmctbGVmdDogLjZyZW07Cn0KLmNvbnRhaW5lcnsKICAgIG1hcmdpbi10b3A6IDNyZW07CiAgICBtYXJnaW4tbGVmdDogNC41cmVtOwogICAgZGlzcGxheTogZmxleDsKICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47Cn0KCgouZGlhbG9newogICAgbWFyZ2luOiAxLjJyZW07Cn0KCg=="},{"version":3,"sources":["Transaction.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAySA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA","file":"Transaction.vue","sourceRoot":"src/components","sourcesContent":["<template>\n    <div class=\"container\">\n        <el-row class=\"top\">\n            <el-col :span=\"titlesize\">\n            <div class=\"top-title\">Transaction System</div>\n            </el-col>\n            <el-col :span=\"buttonsize\" class=\"controll-button\">\n                <el-button :type=\"buttontype\" round  @click=\"flash();start()\" :disabled=\"inprocess\">{{buttontitle}}</el-button>\n            </el-col>\n            <el-col :span=\"roundsize\" class=\"controll-button\">\n                <div class=\"up\">Round</div>\n                <div class=\"down\">{{round}}</div>\n            </el-col>\n        </el-row>\n        <el-row class=\"content\">\n            <el-col :span=\"12\">\n                <transdialog type=\"Deposit into current account\" icon=\"el-icon-wallet\" class=\"dialog\" color=\"in-color\" :records=\"records_deposit_current\"></transdialog>\n            </el-col>\n            <el-col :span=\"12\">\n                <transdialog type=\"Withdrawal from current account\" icon=\"el-icon-bank-card\" class=\"dialog\" color=\"in-color\" :records=\"records_withdrawal_current\"></transdialog>\n            </el-col>\n        </el-row>\n        <el-row class=\"content\">\n            <el-col :span=\"12\">\n                <transdialog type=\"Deposit into savings account\" icon=\"el-icon-wallet\" class=\"dialog\" color=\"out-color\" :records=\"records_deposit_savings\"></transdialog>\n            </el-col>\n            <el-col :span=\"12\">\n                <transdialog type=\"Withdrawal from savings account\" icon=\"el-icon-bank-card\" class=\"dialog\" color=\"out-color\" :records=\"records_withdrawal_savings\"></transdialog>\n            </el-col>\n        </el-row>\n        <el-row class=\"content\">\n            <el-col :span=\"24\">\n                <transdialoglog type=\"Pay monies\" icon=\"el-icon-wallet\" class=\"dialog\" color=\"out-color\" :records=\"records_pay_monies\"></transdialoglog>\n            </el-col>\n        </el-row>\n        <!-- <el-row class=\"content\">\n            <el-col :span=\"24\">\n                <transdialog type=\"Pay monies\" icon=\"el-icon-wallet\" class=\"dialog\" color=\"\"></transdialog>\n            </el-col>\n        </el-row> -->\n        <!-- <el-col :span=\"12\">\n                <transdialog type=\"Create a standing order\" icon=\"el-icon-wallet\" class=\"dialog\" color=\"\"></transdialog>\n            </el-col> -->\n    </div>\n</template>\n\n<script>\nimport transdialog from './TransDialog';\nimport transdialoglog from './TransDialogLog';\nexport default {\n    name: 'transaction',\n    data: function(){\n        return {\n            round: 0,\n            maxRound: 10,\n            buttontitle: 'Start',\n            buttontype: 'warning',\n            inprocess: false,\n            titlesize: 18,\n            buttonsize: 3,\n            roundsize: 3,\n            records: [],\n            records_deposit_current: [],\n            records_withdrawal_current: [],\n            records_deposit_savings:[],\n            records_withdrawal_savings:[],\n            records_pay_monies: []\n        }\n    },\n    components:{transdialog,transdialoglog},\n    mounted(){\n        this.$http.get(\"/api/process/record\").then(function(res) {\n            console.log(\"success\");\n            this.round = res.body[res.body.length-1].round;\n            this.records = res.body;\n            this.records_deposit_current = res.body.reduce((total, current) => {\n                current.type === \"depositCurrentAccount\" && total.push(current);\n                return total;\n            }, []);\n            this.records_withdrawal_current = res.body.reduce((total, current) => {\n                current.type === \"withdrawalCurrentAccount\" && total.push(current);\n                return total;\n            }, []);\n            this.records_deposit_savings = res.body.reduce((total, current) => {\n                current.type === \"depositSavingsAccount\" && total.push(current);\n                return total;\n            }, []);\n            this.records_withdrawal_savings = res.body.reduce((total, current) => {\n                current.type === \"withdrawSavingsAccount\" && total.push(current);\n                return total;\n            }, []);\n            this.records_pay_monies = res.body.reduce((total, current) => {\n                current.type === \"payMonies\" && total.push(current);\n                return total;\n            }, []);\n        },function(res) {\n          console.log('fail...', res);\n        });\n    },\n    methods:{\n        update_s(){\n            this.$http.get(\"/api/process/record\").then(function(res) {\n                console.log(\"update success\");\n                this.round = res.body[res.body.length-1].round;\n                this.records = res.body;\n                this.records_deposit_current = res.body.reduce((total, current) => {\n                current.type === \"depositCurrentAccount\" && total.push(current);\n                return total;\n                }, []);\n                this.records_withdrawal_current = res.body.reduce((total, current) => {\n                current.type === \"withdrawalCurrentAccount\" && total.push(current);\n                return total;\n                }, []);\n                this.records_deposit_savings = res.body.reduce((total, current) => {\n                current.type === \"depositSavingsAccount\" && total.push(current);\n                return total;\n                }, []);             \n                this.records_withdrawal_savings = res.body.reduce((total, current) => {\n                current.type === \"withdrawSavingsAccount\" && total.push(current);\n                return total;\n                }, []);\n                this.records_pay_monies = res.body.reduce((total, current) => {\n                current.type === \"payMonies\" && total.push(current);\n                return total;\n                }, []);\n            })\n        },\n        update(){\n            this.$http.get(\"/api/process/record\").then(function(res) {\n                console.log(\"update success\");\n                this.round = res.body[res.body.length-1].round;\n                this.records = res.body;\n                this.records_deposit_current = res.body.reduce((total, current) => {\n                current.type === \"depositCurrentAccount\" && total.push(current);\n                return total;\n                }, []);\n                this.records_withdrawal_current = res.body.reduce((total, current) => {\n                current.type === \"withdrawalCurrentAccount\" && total.push(current);\n                return total;\n                }, []);\n                this.records_deposit_savings = res.body.reduce((total, current) => {\n                current.type === \"depositSavingsAccount\" && total.push(current);\n                return total;\n                }, []);             \n                this.records_withdrawal_savings = res.body.reduce((total, current) => {\n                current.type === \"withdrawSavingsAccount\" && total.push(current);\n                return total;\n                }, []);\n                this.records_pay_monies = res.body.reduce((total, current) => {\n                current.type === \"payMonies\" && total.push(current);\n                return total;\n                }, []);\n                console.log(\"round \", this.round)\n                this.update_s();\n                if((this.round >= 10) && ((this.round % 10)===0)){\n                    this.buttontitle = 'Phrase';\n                    this.buttontype = 'success';\n                    this.titlesize = 18;\n                    this.buttonsize = 3;\n                    this.inprocess = false;\n                }\n                if(this.round < this.maxRound){\n                    setTimeout(()=>{\n                        this.update_s();\n                        this.start();\n                    }, 5000);\n                }else{\n                    this.maxRound = this.maxRound + 10; \n                    console.log(this.maxRound)\n                }\n            },function(res) {\n                console.log('fail...', res);\n            });\n        },\n        process(){\n            console.log(\"process start\")\n            this.$http.get(\"/api/process/start\").then(function(res) {\n                console.log(\"processing...\");\n                var r = res.body;\n                const loading = this.$loading({\n                    lock: true,\n                    text: r.transaction_type + \" is chosen~\",\n                    spinner: 'el-icon-loading',\n                    background: 'rgba(0, 0, 0, 0.8)',\n                });\n/*                 setTimeout(() => {\n                    loading.close();\n                }, 2000); */\n                setTimeout(() => {\n                    loading.close();\n                    var message;\n                    var message_2;\n                    if (r.type_of_customer !== \"payMonies\"){\n                        message = r.name + \"'s \" + r.type_of_customer + \" \" + r.overall + \".00\";\n                        this.$message({\n                            showClose: true,\n                            message: message,\n                            type: 'success',\n                            duration: 3600,\n                        });\n                    }else{\n                        message = r.name_1 + \"'s Current Account - £\" + r.overall+ \".00\"\n                        message_2 = r.name_2 + \"'s Current Account + £\" + r.overall + \".00\";\n                        this.$message({\n                            showClose: true,\n                            message: message,\n                            type: 'success',\n                            duration: 2000,\n                        });\n                        setTimeout(() => {\n                            this.$message({\n                                showClose: true,\n                                message: message_2,\n                                type: 'success',\n                                duration: 2000,\n                            });  \n                        }, 2200);\n                        \n                    }\n                    // 更新数据\n                    this.update();\n                }, 2600);\n                },function(res) {\n                    console.log('fail...', res);\n                },);\n        },\n        flash(){\n            if(this.buttontitle === 'Start')\n            {\n                try {\n                    this.maxRound = this.records[this.records.length-1].round + 10;\n                }\n                catch(err){\n                    console.log('null');\n                    this.maxRound = 10;\n                }\n                this.buttontitle = 'Processing';\n                this.inprocess = true;\n                this.buttontype = 'info';\n                this.titlesize = 17;\n                this.buttonsize = 4;\n                console.log(this.maxRound)\n            }\n        },\n        start(){\n            this.update_s();\n            if(this.buttontitle !== 'Phrase')\n            {\n                const loading1 = this.$loading({\n                text: 'Transaction in progress...',\n                spinner: 'el-icon-loading',\n                background: 'rgba(0, 0, 0, 0.8)',\n                });\n                setTimeout(() => {\n                    loading1.close();\n                }, 1800);\n                setTimeout(() => {\n                    this.process();\n                }, 2000);\n            }else{\n                this.$http.get(\"/api/process/phrase\").then(function(res) {\n                    console.log(res.status);\n                });\n                this.buttontitle = 'Start';\n                this.buttontype = 'warning';\n                const h = this.$createElement;\n                this.$notify({\n                    type: 'success',\n                    title: 'Bank phrase success',\n                    offset: 105,\n                    duration: 2600,\n                    message: h('i', { style: 'color: teal'}, 'Interest has been calculated and distributed to user accounts～')\n                });\n                setTimeout(() => {\n                    this.$router.push('/users')\n                }, 2600);\n            }\n                \n        },\n\n        /* choose(){\n            const loading = this.$loading({\n                lock: true,\n                text: 'Withdrawal from savings account is chosen～',\n                spinner: 'el-icon-loading',\n                background: 'rgba(0, 0, 0, 0.8)',\n            });\n            setTimeout(() => {\n                loading.close();\n                this.process();\n            }, 2600);\n        } */\n    }\n}\n</script>\n\n<style scoped>\ndiv{\n    margin:0;\n    padding:0;\n}\n.top {\n    background-color: #fff;\n    margin-top: -2.8rem;\n    margin-bottom: 3rem;\n    border-bottom-right-radius: 1.2rem;\n    \n}\n.top-title{\n    background-color: #fff;\n    height:6rem;\n    font-size: 2.5rem;\n    font-weight: bold;\n    text-align: start;\n    padding-left: 2rem;\n    padding-top: 1.3rem;\n    color: #2763d5;\n}\n.controll-button{\n    background-color: #fff;\n}\n.el-button{\n    font-weight: bold;\n    font-size: 1.27rem;\n    margin-top: 1.9rem;\n}\n.up{\n    text-align: start;\n    font-size: 1.1rem;\n    font-weight: bold;\n    color: #b0b0bb;\n    background-color: #fff;\n    margin-bottom: .2rem;\n    padding-left: 0rem;\n    margin-top: 1rem;\n}\n.down{\n    text-align: start;\n    margin-top: 0.5rem;\n    font-size: 2rem;\n    font-weight: bold;\n    color: #272532;\n    background-color: #fff;\n    padding-left: .6rem;\n}\n.container{\n    margin-top: 3rem;\n    margin-left: 4.5rem;\n    display: flex;\n    flex-direction: column;\n}\n\n\n.dialog{\n    margin: 1.2rem;\n}\n\n</style>"]}]}